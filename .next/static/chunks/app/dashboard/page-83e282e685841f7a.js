(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[702],{30679:function(e,t,r){Promise.resolve().then(r.bind(r,28640))},28640:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return B}});var s=r(57437),l=r(2265),a=r(13712),n=r(17147),o=r(38327),i=r(52449),c=r(60090),d=r(94207),u=r(29338),m=r(65607),x=r(13054),f=r(8964),h=r(12270),g=r(87138),v=r(27422),b=r(6884),p=r(90399),j=r(89733),w=r(60891),N=e=>{let{url:t,fetchUrls:r}=e,[a,n]=(0,l.useState)(!1),{loading:i,fn:c}=(0,o.Z)(x.B2,t.id);return(0,s.jsx)("div",{className:"flex justify-center items-center mt-3",children:(0,s.jsxs)("div",{className:"flex mt-1.5 w-2/3 flex-col md:flex-row gap-5 border p-4 bg-[#454548b6] rounded-lg",children:[(null==t?void 0:t.qr_code)&&!a&&(0,s.jsx)("img",{src:t.qr_code,className:"h-32 object-contain ring ring-red-200 self-start",alt:"QR code",onError:()=>n(!0)}),(0,s.jsxs)(g.default,{href:"/link/".concat(null==t?void 0:t.id),className:"flex flex-col flex-1",children:[(0,s.jsx)("span",{className:"text-3xl font-extrabold hover:underline cursor-pointer",children:(null==t?void 0:t.title)||(null==t?void 0:t.original_url)}),(0,s.jsxs)("span",{className:"text-2xl text-blue-400 font-bold hover:underline cursor-pointer",children:[window.location.origin,"/",(null==t?void 0:t.custom_url)||(null==t?void 0:t.short_url)]}),(0,s.jsxs)("span",{className:"flex items-center gap-1 hover:underline cursor-pointer",children:[(0,s.jsx)(v.Z,{className:"p-1"}),null==t?void 0:t.original_url]}),(0,s.jsx)("span",{className:"flex items-end font-extralight text-sm flex-1",children:new Date(null==t?void 0:t.created_at).toLocaleString()})]}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)(j.z,{variant:"ghost",onClick:()=>{let e="".concat(window.location.origin,"/").concat((null==t?void 0:t.custom_url)||(null==t?void 0:t.short_url));navigator.clipboard.writeText(e)},className:"hover:bg-primary/20",title:"Copy short URL",children:(0,s.jsx)(b.Z,{})}),(0,s.jsx)(j.z,{variant:"ghost",onClick:()=>c().then(()=>r()),disabled:i,className:"hover:bg-primary/20",title:"Delete URL",children:i?(0,s.jsx)(w.Z,{size:5,color:"white"}):(0,s.jsx)(p.Z,{})})]})]})})},y=r(59886),k=r(74697),_=r(58214);function U(e){let{...t}=e;return(0,s.jsx)(y.fC,{"data-slot":"dialog",...t})}function C(e){let{...t}=e;return(0,s.jsx)(y.xz,{"data-slot":"dialog-trigger",...t})}function L(e){let{...t}=e;return(0,s.jsx)(y.h_,{"data-slot":"dialog-portal",...t})}function E(e){let{className:t,...r}=e;return(0,s.jsx)(y.aV,{"data-slot":"dialog-overlay",className:(0,_.cn)("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",t),...r})}function R(e){let{className:t,children:r,...l}=e;return(0,s.jsxs)(L,{"data-slot":"dialog-portal",children:[(0,s.jsx)(E,{}),(0,s.jsxs)(y.VY,{"data-slot":"dialog-content",className:(0,_.cn)("bg-[#41414b] data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg",t),...l,children:[(0,s.jsx)(I,{children:"Please fill out the form to create a new link."}),r,(0,s.jsxs)(y.x8,{className:"ring-offset-background focus:ring-ring data-[state=open]:bg-accent data-[state=open]:text-muted-foreground absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",children:[(0,s.jsx)(k.Z,{}),(0,s.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})}function Z(e){let{className:t,...r}=e;return(0,s.jsx)("div",{"data-slot":"dialog-header",className:(0,_.cn)("flex flex-col gap-2 text-center sm:text-left",t),...r})}function z(e){let{className:t,...r}=e;return(0,s.jsx)("div",{"data-slot":"dialog-footer",className:(0,_.cn)("flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",t),...r})}function S(e){let{className:t,...r}=e;return(0,s.jsx)(y.Dx,{"data-slot":"dialog-title",className:(0,_.cn)("text-lg leading-none font-semibold",t),...r})}function I(e){let{className:t,...r}=e;return(0,s.jsx)(y.dk,{"data-slot":"dialog-description",className:(0,_.cn)("text-muted-foreground text-sm",t),...r})}var M=r(16463),D=e=>{let{message:t}=e;return(0,s.jsx)("span",{className:"text-sm text-red-400",children:t})},q=r(14245),A=r(19783);function O(){let e=(0,M.useRouter)(),[t,r]=(0,l.useState)(!1),[a,o]=(0,l.useState)({}),[i,c]=(0,l.useState)(!1),[d,u]=(0,l.useState)({original_url:"",customUrl:""}),m=(0,l.useMemo)(()=>q.Ry().shape({original_url:q.Z_().trim().url("Must be a valid URL").required("Long URL is required"),customUrl:q.Z_().trim().matches(/^[a-zA-Z0-9-_]*$/,"Only letters, numbers, hyphens and underscores are allowed").min(3,"Custom URL must be at least 3 characters").max(20,"Custom URL must be less than 20 characters").nullable().transform(e=>""===e?null:e)}),[]),f=(0,l.useCallback)(e=>{let{id:t,value:r}=e.target;u(e=>({...e,[t]:r||""})),o(e=>{if(!e[t])return e;let r={...e};return delete r[t],r})},[]),h=(0,l.useCallback)(async e=>{try{return await A.toDataURL(e,{width:300,margin:2,color:{dark:"#000000",light:"#ffffff"},errorCorrectionLevel:"M"})}catch(e){return console.error("Error generating QR code:",e),null}},[]),g=(0,l.useCallback)(async()=>{o({}),c(!0);try{let t=await m.validate(d,{abortEarly:!1});t.customUrl;let s=t.customUrl||"temp",l="".concat(window.location.origin,"/").concat(s),a=await h(l),n=await (0,x.uJ)({longUrl:t.original_url,customUrl:t.customUrl},a);u({original_url:"",customUrl:""}),r(!1),e.push("/link/".concat(n.id))}catch(e){if(console.error("Error creating link:",e),e.inner){let t={};e.inner.forEach(e=>{t[e.path]=e.message}),o(t)}else o({message:e.message||"Failed to create link"})}finally{c(!1)}},[d,m,h,e]),v=(0,l.useMemo)(()=>i||!d.original_url.trim(),[i,d.original_url]);return(0,s.jsxs)(U,{open:t,onOpenChange:r,children:[(0,s.jsx)(C,{asChild:!0,children:(0,s.jsx)(j.z,{variant:"destructive",children:"Create New Link"})}),(0,s.jsxs)(R,{className:"sm:max-w-md",children:[(0,s.jsx)(Z,{children:(0,s.jsx)(S,{className:"font-bold text-2xl",children:"Create New"})}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(n.I,{id:"original_url",placeholder:"Enter your Long URL",value:d.original_url,onChange:f,className:a.original_url?"border-red-500":"",autoComplete:"url"}),a.original_url&&(0,s.jsx)(D,{message:a.original_url})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(n.I,{id:"customUrl",placeholder:"Custom short URL (optional)",value:d.customUrl,onChange:f,className:a.customUrl?"border-red-500":"",autoComplete:"off"}),a.customUrl&&(0,s.jsx)(D,{message:a.customUrl}),(0,s.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"3-20 characters: letters, numbers, hyphens, underscores"})]})]}),a.message&&(0,s.jsx)(D,{message:a.message}),(0,s.jsx)(z,{className:"sm:justify-start",children:(0,s.jsx)(j.z,{type:"button",variant:"destructive",onClick:g,disabled:v,children:i?(0,s.jsx)(w.Z,{size:10,color:"white"}):"Create"})})]})]})}var T=r(94430);function F(){let[e,t]=(0,l.useState)([]),[r,a]=(0,l.useState)(!1),[n,o]=(0,l.useState)(null),i=async()=>{a(!0);try{let{data:e,error:r}=await T.Z.from("urls").select("id, short_url, custom_url, original_url, user_id, clicks").order("created_at",{ascending:!1}).limit(10);r?(console.error("Error fetching URLs:",r),o({error:r.message})):(console.log("URLs in database:",e),t(e||[]),o({success:!0,count:(null==e?void 0:e.length)||0}))}catch(e){console.error("Debug error:",e),o({error:e.message})}finally{a(!1)}},c=async e=>{console.log("Testing lookup for: ".concat(e));try{let{data:t,error:r}=await T.Z.from("urls").select("*").or("short_url.eq.".concat(e,",custom_url.eq.").concat(e)).maybeSingle();console.log("Result for ".concat(e,":"),{data:t,error:r}),alert("Lookup ".concat(e,": ").concat(t?"FOUND":"NOT FOUND","\n").concat(t?t.original_url:(null==r?void 0:r.message)||"No match"))}catch(e){console.error("Test error:",e),alert("Error: ".concat(e.message))}};return(0,s.jsxs)("div",{className:"p-4 border rounded-lg bg-gray-800 text-white",children:[(0,s.jsx)("h3",{className:"text-lg font-bold mb-4",children:"\uD83D\uDC1B Debug URLs in Database"}),(0,s.jsx)("div",{className:"flex gap-2 mb-4",children:(0,s.jsx)(j.z,{onClick:i,disabled:r,variant:"outline",children:r?"Loading...":"Fetch All URLs"})}),n&&(0,s.jsx)("div",{className:"p-2 rounded mb-4 ".concat(n.error?"bg-red-900":"bg-green-900"),children:n.error?"Error: ".concat(n.error):"Success! Found ".concat(n.count," URLs")}),e.length>0&&(0,s.jsxs)("div",{className:"mt-4",children:[(0,s.jsxs)("h4",{className:"font-semibold mb-2",children:["URLs in Database (",e.length,"):"]}),(0,s.jsx)("div",{className:"space-y-2 max-h-96 overflow-y-auto",children:e.map((e,t)=>(0,s.jsxs)("div",{className:"p-3 bg-gray-700 rounded text-sm border border-gray-600",children:[(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,s.jsx)("div",{className:"font-semibold",children:"ID:"}),(0,s.jsx)("div",{className:"font-mono text-xs",children:e.id}),(0,s.jsx)("div",{className:"font-semibold",children:"Short URL:"}),(0,s.jsx)("div",{className:"font-mono text-blue-400",children:e.short_url||"null"}),(0,s.jsx)("div",{className:"font-semibold",children:"Custom URL:"}),(0,s.jsx)("div",{className:"font-mono text-purple-400",children:e.custom_url||"none"}),(0,s.jsx)("div",{className:"font-semibold",children:"Original:"}),(0,s.jsx)("div",{className:"text-xs break-all",children:e.original_url}),(0,s.jsx)("div",{className:"font-semibold",children:"User ID:"}),(0,s.jsx)("div",{className:"font-mono text-xs",children:e.user_id||"null"}),(0,s.jsx)("div",{className:"font-semibold",children:"Clicks:"}),(0,s.jsx)("div",{children:e.clicks||0})]}),(0,s.jsxs)("div",{className:"mt-2 flex gap-2",children:[(0,s.jsx)(j.z,{size:"sm",variant:"ghost",onClick:()=>c(e.custom_url||e.short_url),children:"Test Lookup"}),(0,s.jsx)(j.z,{size:"sm",variant:"ghost",onClick:()=>{let t=e.custom_url||e.short_url;window.open("/".concat(t),"_blank")},children:"Try Redirect"})]})]},t))})]}),0===e.length&&!r&&(0,s.jsx)("div",{className:"text-gray-400 text-center p-4",children:'No URLs loaded. Click "Fetch All URLs" to see what\'s in the database.'})]})}function J(e){let{value:t}=e,[r,a]=(0,l.useState)(0);return(0,l.useEffect)(()=>{let e=t||0;if(0===e){a(0);return}let r=e/50,s=0,l=setInterval(()=>{(s+=r)>=e?(a(e),clearInterval(l)):a(Math.floor(s))},16);return()=>clearInterval(l)},[t]),(0,s.jsx)("span",{children:r})}function B(){let[e,t]=(0,l.useState)(""),{loading:r,error:g,data:v,fn:b}=(0,o.Z)(x.Um),{loading:p,data:j,fn:w}=(0,o.Z)(h.N3,null==v?void 0:v.map(e=>e.id));(0,l.useEffect)(()=>{b()},[b]),(0,l.useEffect)(()=>{(null==v?void 0:v.length)&&w()},[v,w]);let y=(0,l.useCallback)(e=>{t(e.target.value)},[]),k=(0,l.useMemo)(()=>{if(!v)return[];if(!e.trim())return v;let t=e.toLowerCase();return v.filter(e=>{let r=e.title||e.original_url||"",s=e.short_url||"",l=e.custom_url||"";return r.toLowerCase().includes(t)||s.toLowerCase().includes(t)||l.toLowerCase().includes(t)})},[v,e]),_=(0,l.useMemo)(()=>{if(!v)return{activeLinks:0,mostClicked:null};let e=new Date,t=v.filter(t=>{let r=new Date(t.created_at);return(e.getTime()-r.getTime())/864e5<=7}).length,r=null;return j&&(r=v.map(e=>({...e,clickCount:j.filter(t=>t.url_id===e.id).length})).reduce((e,t)=>t.clickCount>((null==e?void 0:e.clickCount)||0)?t:e,null)),{activeLinks:t,mostClicked:r}},[v,j]);return(0,s.jsxs)("div",{className:"min-h-screen w-full max-w-6xl mx-auto px-2 sm:px-4 py-6 sm:py-8",children:[(r||p)&&(0,s.jsx)(f.Z,{width:"100%",color:"#91939f"}),(0,s.jsx)("div",{className:"mb-6",children:(0,s.jsx)(F,{})}),(0,s.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 sm:gap-6 mb-6",children:[(0,s.jsxs)(a.Zb,{className:"flex flex-row items-center gap-4 bg-[#f7f7f8] text-black shadow-md p-3 sm:p-4 w-full",children:[(0,s.jsx)("div",{className:"p-3 rounded-full bg-blue-100",children:(0,s.jsx)(i.Z,{className:"h-7 w-7 text-blue-600"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)(a.ll,{className:"text-base sm:text-lg font-bold",children:"Links Created"}),(0,s.jsx)(a.aY,{className:"p-0 text-2xl sm:text-3xl font-extrabold",children:(0,s.jsx)(J,{value:(null==v?void 0:v.length)||0})})]})]}),(0,s.jsxs)(a.Zb,{className:"flex flex-row items-center gap-4 bg-[#f7f7f8] text-black shadow-md p-3 sm:p-4 w-full",children:[(0,s.jsx)("div",{className:"p-3 rounded-full bg-green-100",children:(0,s.jsx)(c.Z,{className:"h-7 w-7 text-green-600"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)(a.ll,{className:"text-base sm:text-lg font-bold",children:"Total Clicks"}),(0,s.jsx)(a.aY,{className:"p-0 text-2xl sm:text-3xl font-extrabold",children:(0,s.jsx)(J,{value:(null==j?void 0:j.length)||0})})]})]}),(0,s.jsxs)(a.Zb,{className:"flex flex-row items-center gap-4 bg-[#f7f7f8] text-black shadow-md p-3 sm:p-4 w-full",children:[(0,s.jsx)("div",{className:"p-3 rounded-full bg-yellow-100",children:(0,s.jsx)(d.Z,{className:"h-7 w-7 text-yellow-600"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)(a.ll,{className:"text-base sm:text-lg font-bold",children:"Active Links"}),(0,s.jsx)(a.aY,{className:"p-0 text-2xl sm:text-3xl font-extrabold",children:(0,s.jsx)(J,{value:_.activeLinks})})]})]}),(0,s.jsxs)(a.Zb,{className:"flex flex-row items-center gap-4 bg-[#f7f7f8] text-black shadow-md p-3 sm:p-4 w-full",children:[(0,s.jsx)("div",{className:"p-3 rounded-full bg-purple-100",children:(0,s.jsx)(u.Z,{className:"h-7 w-7 text-purple-600"})}),(0,s.jsxs)("div",{className:"truncate max-w-[120px]",children:[(0,s.jsx)(a.ll,{className:"text-base sm:text-lg font-bold",children:"Most Clicked"}),(0,s.jsx)(a.aY,{className:"p-0 text-xs sm:text-base font-semibold truncate",children:_.mostClicked?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("span",{className:"block truncate",children:_.mostClicked.title}),(0,s.jsxs)("span",{className:"block text-purple-700 text-lg",children:[_.mostClicked.clickCount," clicks"]})]}):(0,s.jsx)("span",{className:"text-gray-500",children:"N/A"})})]})]})]}),(0,s.jsxs)("div",{className:"w-full flex flex-col sm:flex-row items-center justify-between gap-4 mb-4 bg-[#18181b] py-2 px-2 sm:px-4 rounded-lg sticky top-2 z-10",children:[(0,s.jsx)("h1",{className:"text-2xl sm:text-3xl md:text-4xl font-extrabold w-full sm:w-auto text-center sm:text-left",children:"My Links"}),(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row items-center gap-2 w-full sm:w-auto",children:[(0,s.jsxs)("div",{className:"relative w-full sm:w-64",children:[(0,s.jsx)(n.I,{type:"text",placeholder:"Filter Links...",className:"w-full pl-10",value:e,onChange:y}),(0,s.jsx)(m.Z,{className:"absolute left-2 top-1/2 transform -translate-y-1/2 text-gray-400"})]}),(0,s.jsx)(O,{})]})]}),(0,s.jsxs)("div",{children:[g&&(0,s.jsx)("div",{className:"text-red-500 text-center",children:null==g?void 0:g.message}),k&&0===k.length&&(0,s.jsxs)("div",{className:"text-center text-gray-400 py-16",children:[(0,s.jsx)("div",{className:"text-2xl mb-2",children:"No links found"}),(0,s.jsx)("div",{className:"mb-4",children:"Try creating a new link or adjusting your filter."}),(0,s.jsx)(O,{})]}),(0,s.jsx)("div",{className:"mt-4",children:(0,s.jsx)("div",{className:"flex flex-col gap-6 w-full",children:(k||[]).map((e,t)=>(0,s.jsx)(N,{url:e,fetchUrls:b},t))})})]})]})}},89733:function(e,t,r){"use strict";r.d(t,{z:function(){return c}});var s=r(57437),l=r(2265),a=r(71538),n=r(13027),o=r(58214);let i=(0,n.j)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",{variants:{variant:{default:"bg-primary text-white shadow-xs hover:bg-primary/30",destructive:"bg-destructive text-white shadow-xs hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",secondary:"bg-secondary text-secondary-foreground shadow-xs hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9"}},defaultVariants:{variant:"default",size:"default"}}),c=l.forwardRef((e,t)=>{let{className:r,variant:l,size:n,asChild:c=!1,...d}=e,u=c?a.g7:"button";return(0,s.jsx)(u,{ref:t,"data-slot":"button",className:(0,o.cn)(i({variant:l,size:n,className:r})),...d})});c.displayName="Button"},13712:function(e,t,r){"use strict";r.d(t,{Ol:function(){return n},SZ:function(){return i},Zb:function(){return a},aY:function(){return c},ll:function(){return o}});var s=r(57437);r(2265);var l=r(58214);function a(e){let{className:t="",...r}=e;return(0,s.jsx)("div",{"data-slot":"card",className:(0,l.cn)("bg-[#f7f7f8] text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm h-36",t),...r})}function n(e){let{className:t="",...r}=e;return(0,s.jsx)("div",{"data-slot":"card-header",className:(0,l.cn)("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-1.5 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6 text-black",t),...r})}function o(e){let{className:t="",...r}=e;return(0,s.jsx)("div",{"data-slot":"card-title",className:(0,l.cn)("leading-none  text-black font-semibold",t),...r})}function i(e){let{className:t="",...r}=e;return(0,s.jsx)("div",{"data-slot":"card-description",className:(0,l.cn)("text-muted-foreground text-sm text-black",t),...r})}function c(e){let{className:t="",...r}=e;return(0,s.jsx)("div",{"data-slot":"card-content",className:(0,l.cn)("px-6",t),...r})}},17147:function(e,t,r){"use strict";r.d(t,{I:function(){return a}});var s=r(57437);r(2265);var l=r(58214);function a(e){let{className:t,type:r,...a}=e;return(0,s.jsx)("input",{type:r,"data-slot":"input",className:(0,l.cn)("file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input flex h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",t),...a})}},12270:function(e,t,r){"use strict";r.d(t,{N3:function(){return a},Wj:function(){return n}});var s=r(64878),l=r(94430);async function a(e){let{data:t,error:r}=await l.Z.from("clicks").select("*").in("url_id",e);return r?(console.error("Error fetching clicks:",r),null):t}async function n(e){let{data:t,error:r}=await l.Z.from("clicks").select("*").eq("url_id",e);if(r)throw console.error(r),Error("Unable to load Stats");return t}new s.M},13054:function(e,t,r){"use strict";r.d(t,{B2:function(){return m},Gr:function(){return o},Um:function(){return n},uJ:function(){return u}});var s=r(94430);let l=new Map,a={get:e=>{let t=l.get(e);return t?Date.now()>t.expiry?(l.delete(e),null):t.data:null},set:function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3e5;if(l.set(e,{data:t,expiry:Date.now()+r}),l.size>100){let e=l.keys().next().value;l.delete(e)}},invalidate:e=>{if("*"===e)l.clear();else for(let t of l.keys())t.includes(e)&&l.delete(t)}};async function n(e){let t=!(arguments.length>1)||void 0===arguments[1]||arguments[1],r="urls_".concat(e||"all");if(t){let e=a.get(r);if(e)return e}try{let e=s.Z.from("urls").select("*").order("created_at",{ascending:!1}),{data:t,error:l}=await e;if(l)throw l;let n=t||[];return a.set(r,n),n}catch(e){throw console.error("Error fetching URLs:",e),Error("Unable to load URLs")}}async function o(e){let t=!(arguments.length>1)||void 0===arguments[1]||arguments[1],r="url_".concat(e);if(t){let e=a.get(r);if(e)return e}try{let{data:t,error:l}=await s.Z.from("urls").select("*").eq("id",e).single();if(l)throw l;if(!t)throw Error("URL not found");return a.set(r,t),t}catch(e){throw console.error("Error fetching URL:",e),Error("URL not found")}}let i=(()=>{let e="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ",t=Date.now();return function(){let r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:6,s="",l=++t+Math.floor(1e6*Math.random());for(;l>0&&s.length<r;)s=e[l%62]+s,l=Math.floor(l/62);for(;s.length<r;)s=e[Math.floor(62*Math.random())]+s;return s}})(),c=e=>{if(!e)throw Error("URL is required");let t=e.trim();if(!t)throw Error("URL cannot be empty");return/^https?:\/\//i.test(t)?t:"https://".concat(t)},d=e=>{if(!e)return null;let t=e.trim().toLowerCase();if(!/^[a-z0-9_-]+$/.test(t))throw Error("Custom URL can only contain letters, numbers, hyphens, and underscores");if(t.length<3||t.length>20)throw Error("Custom URL must be between 3 and 20 characters");return t};async function u(e,t){let{title:r,longUrl:l,customUrl:n}=e;try{let e;let o=c(l),u=d(n);if(u){let{data:e}=await s.Z.from("urls").select("id").or("custom_url.eq.".concat(u,",short_url.eq.").concat(u)).maybeSingle();if(e)throw Error("Custom URL already taken. Please try another one.")}let m=0;for(;m<3;){e=i(6);let{data:t}=await s.Z.from("urls").select("id").eq("short_url",e).maybeSingle();if(!t)break;m++}if(3===m)throw Error("Failed to generate unique short URL. Please try again.");let{data:x,error:f}=await s.Z.from("urls").insert([{title:r||o,user_id:null,original_url:o,custom_url:u,short_url:e,qr_code:t||null,clicks:0}]).select().single();if(f)throw console.error("Error creating URL:",f),Error(f.message);return a.invalidate("urls_"),x}catch(e){throw console.error("Error in createUrl:",e),Error(e.message||"Error creating short URL")}}async function m(e){try{let{error:t}=await s.Z.from("urls").delete().eq("id",e);if(t)throw t;a.invalidate("*")}catch(e){throw console.error("Error deleting URL:",e),Error("Unable to delete URL")}}},94430:function(e,t,r){"use strict";var s=r(95646);let l="https://epyutufurcgskuzwiqce.supabase.co",a="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImVweXV0dWZ1cmNnc2t1endpcWNlIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjIyMjAzMTAsImV4cCI6MjA3Nzc5NjMxMH0.Dmusxo1ghDmyHQk0Jf_SgEjOTfIk3OJCF0mbuK_sXcM";if(!l||!a)throw console.error("Missing Supabase environment variables. Please set NEXT_PUBLIC_SUPABASE_URL and NEXT_PUBLIC_SUPABASE_ANON_KEY in .env.local"),Error("Missing Supabase environment variables");let n=(0,s.eI)(l,a);t.Z=n},38327:function(e,t,r){"use strict";var s=r(2265);t.Z=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},[r,l]=(0,s.useState)(null),[a,n]=(0,s.useState)(null),[o,i]=(0,s.useState)(null);return{data:r,loading:a,error:o,fn:async function(){for(var r=arguments.length,s=Array(r),a=0;a<r;a++)s[a]=arguments[a];n(!0),i(null);try{let r=await e(t,...s);l(r),i(null)}catch(e){i(e)}finally{n(!1)}}}}},58214:function(e,t,r){"use strict";r.d(t,{cn:function(){return a}});var s=r(44839),l=r(96164);function a(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,l.m6)((0,s.W)(t))}}},function(e){e.O(0,[126,225,500,971,23,744],function(){return e(e.s=30679)}),_N_E=e.O()}]);