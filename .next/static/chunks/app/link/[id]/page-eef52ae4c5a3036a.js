(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[770],{69169:function(e,t,r){Promise.resolve().then(r.bind(r,22066))},22066:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return C}});var s=r(57437),n=r(2265),a=r(16463),l=r(13712),i=r(89733),o=r(95137),c=r(23787),d=r(6884),u=r(62810),f=r(68879),h=r(38327),x=r(13054),m=r(12270),g=r(8964),b=r(35231),v=r(23909),j=r(85369),p=r(68295),w=r(85475),y=r(20153);let N=["#0088FE","#00C49F","#FFBB28","#FF8042","#8884d8"];function k(e){let{stats:t=[]}=e,r=t.reduce((e,t)=>(e[t.device]||(e[t.device]=0),e[t.device]++,e),{}),n=Object.keys(r).map(e=>({device:e,count:r[e]}));return(0,s.jsxs)("div",{className:"w-full h-80 flex flex-col justify-center",children:[(0,s.jsx)("div",{className:"text-white text-lg font-semibold mb-2",children:"Device Distribution"}),(0,s.jsx)("div",{className:"w-full h-full",children:(0,s.jsx)(b.h,{width:"100%",height:"100%",children:(0,s.jsxs)(v.u,{children:[(0,s.jsx)(j.b,{data:n,dataKey:"count",nameKey:"device",cx:"50%",cy:"50%",outerRadius:100,fill:"#8884d8",label:e=>{let{device:t,percent:r}=e;return"".concat(t,": ").concat((100*r).toFixed(0),"%")},labelLine:!1,children:n.map((e,t)=>(0,s.jsx)(p.b,{fill:N[t%N.length]},"cell-".concat(t)))}),(0,s.jsx)(w.u,{content:(0,s.jsx)(e=>{let{active:t,payload:r}=e;return t&&r&&r.length?(0,s.jsxs)("div",{className:"bg-[#44455a] text-white p-2 border border-gray-500 rounded shadow",children:[(0,s.jsx)("p",{className:"font-semibold",children:r[0].name}),(0,s.jsxs)("p",{className:"text-sm",children:["Count: ",r[0].value]})]}):null},{}),cursor:{stroke:"#b8b9c1",strokeWidth:1}}),(0,s.jsx)(y.D,{wrapperStyle:{color:"#fff"}})]})})})]})}var _=r(92566),E=r(54142),Z=r(2842),U=r(9542),L=r(16638);function R(e){let{stats:t=[]}=e,r=Object.entries(t.reduce((e,t)=>(e[t.city]?e[t.city]+=1:e[t.city]=1,e),{})).map(e=>{let[t,r]=e;return{city:t,count:r}}).sort((e,t)=>t.count-e.count).slice(0,5);return(0,s.jsxs)("div",{className:"w-full h-72 flex flex-col justify-center",children:[(0,s.jsx)("div",{className:"text-white text-lg font-semibold mb-2",children:"Top 5 Locations"}),(0,s.jsx)("div",{className:"w-full h-full",children:(0,s.jsx)(b.h,{width:"100%",height:"100%",children:(0,s.jsxs)(_.w,{data:r,margin:{top:10,right:20,left:0,bottom:30},children:[(0,s.jsx)(E.q,{strokeDasharray:"3 3",stroke:"#b8b9c1"}),(0,s.jsx)(Z.K,{dataKey:"city",angle:-45,textAnchor:"end",height:70,interval:0,stroke:"#fff",tick:{fill:"#fff"}}),(0,s.jsx)(U.B,{stroke:"#fff",tick:{fill:"#fff"}}),(0,s.jsx)(w.u,{content:(0,s.jsx)(e=>{let{active:t,payload:r,label:n}=e;return t&&r&&r.length?(0,s.jsxs)("div",{className:"bg-[#44455a] text-white p-2 border border-gray-500 rounded shadow",children:[(0,s.jsx)("p",{className:"font-semibold",children:n}),(0,s.jsxs)("p",{className:"text-sm",children:["Visits: ",r[0].value]})]}):null},{}),cursor:{stroke:"#b8b9c1",strokeWidth:1}}),(0,s.jsx)(y.D,{wrapperStyle:{color:"#fff"}}),(0,s.jsx)(L.x,{type:"monotone",dataKey:"count",stroke:"#b8b9c1",strokeWidth:2,dot:{r:4,stroke:"#fff",fill:"#b8b9c1"},activeDot:{r:6,stroke:"#fff",fill:"#b8b9c1"}})]})})})]})}function C(e){let{params:t}=e,r=(0,a.useRouter)(),{id:b}=t,{loading:v,data:j,fn:p}=(0,h.Z)(x.Gr,b),{loading:w,data:y,fn:N}=(0,h.Z)(m.Wj,b);if((0,n.useEffect)(()=>{p()},[b]),(0,n.useEffect)(()=>{j&&N()},[j]),v)return(0,s.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,s.jsx)(g.Z,{width:"100%",color:"#91939f"})});if(!j)return(0,s.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,s.jsxs)(l.Zb,{className:"max-w-md",children:[(0,s.jsx)(l.Ol,{children:(0,s.jsx)(l.ll,{children:"Link Not Found"})}),(0,s.jsxs)(l.aY,{children:[(0,s.jsx)("p",{className:"text-muted-foreground mb-4",children:"This link doesn't exist or has been deleted."}),(0,s.jsxs)(i.z,{onClick:()=>r.push("/dashboard"),children:[(0,s.jsx)(o.Z,{className:"mr-2 h-4 w-4"}),"Back to Dashboard"]})]})]})});let _="".concat(window.location.origin,"/").concat(j.custom_url||j.short_url);return(0,s.jsxs)("div",{className:"min-h-screen w-full max-w-6xl mx-auto px-4 py-8",children:[(0,s.jsxs)(i.z,{variant:"ghost",onClick:()=>r.push("/dashboard"),className:"mb-6",children:[(0,s.jsx)(o.Z,{className:"mr-2 h-4 w-4"}),"Back to Dashboard"]}),(0,s.jsxs)(l.Zb,{className:"mb-6",children:[(0,s.jsx)(l.Ol,{children:(0,s.jsx)(l.ll,{className:"text-2xl flex items-center gap-2",children:j.title||"Untitled Link"})}),(0,s.jsxs)(l.aY,{className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm text-muted-foreground mb-1",children:"Short URL"}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsxs)("a",{href:_,target:"_blank",rel:"noopener noreferrer",className:"text-blue-500 hover:underline flex items-center gap-1",children:[_,(0,s.jsx)(c.Z,{className:"h-4 w-4"})]}),(0,s.jsx)(i.z,{variant:"ghost",size:"sm",onClick:()=>{navigator.clipboard.writeText(_)},children:(0,s.jsx)(d.Z,{className:"h-4 w-4"})})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm text-muted-foreground mb-1",children:"Original URL"}),(0,s.jsxs)("a",{href:j.original_url,target:"_blank",rel:"noopener noreferrer",className:"text-sm text-blue-500 hover:underline break-all flex items-center gap-1",children:[j.original_url,(0,s.jsx)(c.Z,{className:"h-4 w-4"})]})]}),(0,s.jsxs)("div",{className:"flex gap-6 pt-4 border-t",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"Total Clicks"}),(0,s.jsx)("p",{className:"text-2xl font-bold",children:j.clicks||0})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"Created"}),(0,s.jsx)("p",{className:"text-lg",children:new Date(j.created_at).toLocaleDateString()})]})]}),j.qr_code&&(0,s.jsxs)("div",{className:"pt-4 border-t",children:[(0,s.jsxs)("p",{className:"text-sm text-muted-foreground mb-2 flex items-center gap-2",children:[(0,s.jsx)(u.Z,{className:"h-4 w-4"}),"QR Code"]}),(0,s.jsx)("img",{src:j.qr_code,alt:"QR Code",className:"w-48 h-48 border rounded-lg"})]})]})]}),w?(0,s.jsx)(g.Z,{width:"100%",color:"#91939f"}):y&&y.length>0?(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("h2",{className:"text-2xl font-bold flex items-center gap-2",children:[(0,s.jsx)(f.Z,{className:"h-6 w-6"}),"Analytics"]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,s.jsx)(R,{stats:y}),(0,s.jsx)(k,{stats:y})]})]}):(0,s.jsx)(l.Zb,{children:(0,s.jsx)(l.aY,{className:"py-8 text-center text-muted-foreground",children:"No analytics data yet. Share your link to start tracking clicks!"})})]})}},89733:function(e,t,r){"use strict";r.d(t,{z:function(){return c}});var s=r(57437),n=r(2265),a=r(71538),l=r(13027),i=r(58214);let o=(0,l.j)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",{variants:{variant:{default:"bg-primary text-white shadow-xs hover:bg-primary/30",destructive:"bg-destructive text-white shadow-xs hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",secondary:"bg-secondary text-secondary-foreground shadow-xs hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9"}},defaultVariants:{variant:"default",size:"default"}}),c=n.forwardRef((e,t)=>{let{className:r,variant:n,size:l,asChild:c=!1,...d}=e,u=c?a.g7:"button";return(0,s.jsx)(u,{ref:t,"data-slot":"button",className:(0,i.cn)(o({variant:n,size:l,className:r})),...d})});c.displayName="Button"},13712:function(e,t,r){"use strict";r.d(t,{Ol:function(){return l},SZ:function(){return o},Zb:function(){return a},aY:function(){return c},ll:function(){return i}});var s=r(57437);r(2265);var n=r(58214);function a(e){let{className:t="",...r}=e;return(0,s.jsx)("div",{"data-slot":"card",className:(0,n.cn)("bg-[#f7f7f8] text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm h-36",t),...r})}function l(e){let{className:t="",...r}=e;return(0,s.jsx)("div",{"data-slot":"card-header",className:(0,n.cn)("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-1.5 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6 text-black",t),...r})}function i(e){let{className:t="",...r}=e;return(0,s.jsx)("div",{"data-slot":"card-title",className:(0,n.cn)("leading-none  text-black font-semibold",t),...r})}function o(e){let{className:t="",...r}=e;return(0,s.jsx)("div",{"data-slot":"card-description",className:(0,n.cn)("text-muted-foreground text-sm text-black",t),...r})}function c(e){let{className:t="",...r}=e;return(0,s.jsx)("div",{"data-slot":"card-content",className:(0,n.cn)("px-6",t),...r})}},12270:function(e,t,r){"use strict";r.d(t,{N3:function(){return a},Wj:function(){return l}});var s=r(64878),n=r(94430);async function a(e){let{data:t,error:r}=await n.Z.from("clicks").select("*").in("url_id",e);return r?(console.error("Error fetching clicks:",r),null):t}async function l(e){let{data:t,error:r}=await n.Z.from("clicks").select("*").eq("url_id",e);if(r)throw console.error(r),Error("Unable to load Stats");return t}new s.M},13054:function(e,t,r){"use strict";r.d(t,{B2:function(){return f},Gr:function(){return i},Um:function(){return l},uJ:function(){return u}});var s=r(94430);let n=new Map,a={get:e=>{let t=n.get(e);return t?Date.now()>t.expiry?(n.delete(e),null):t.data:null},set:function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3e5;if(n.set(e,{data:t,expiry:Date.now()+r}),n.size>100){let e=n.keys().next().value;n.delete(e)}},invalidate:e=>{if("*"===e)n.clear();else for(let t of n.keys())t.includes(e)&&n.delete(t)}};async function l(e){let t=!(arguments.length>1)||void 0===arguments[1]||arguments[1],r="urls_".concat(e||"all");if(t){let e=a.get(r);if(e)return e}try{let e=s.Z.from("urls").select("*").order("created_at",{ascending:!1}),{data:t,error:n}=await e;if(n)throw n;let l=t||[];return a.set(r,l),l}catch(e){throw console.error("Error fetching URLs:",e),Error("Unable to load URLs")}}async function i(e){let t=!(arguments.length>1)||void 0===arguments[1]||arguments[1],r="url_".concat(e);if(t){let e=a.get(r);if(e)return e}try{let{data:t,error:n}=await s.Z.from("urls").select("*").eq("id",e).single();if(n)throw n;if(!t)throw Error("URL not found");return a.set(r,t),t}catch(e){throw console.error("Error fetching URL:",e),Error("URL not found")}}let o=(()=>{let e="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ",t=Date.now();return function(){let r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:6,s="",n=++t+Math.floor(1e6*Math.random());for(;n>0&&s.length<r;)s=e[n%62]+s,n=Math.floor(n/62);for(;s.length<r;)s=e[Math.floor(62*Math.random())]+s;return s}})(),c=e=>{if(!e)throw Error("URL is required");let t=e.trim();if(!t)throw Error("URL cannot be empty");return/^https?:\/\//i.test(t)?t:"https://".concat(t)},d=e=>{if(!e)return null;let t=e.trim().toLowerCase();if(!/^[a-z0-9_-]+$/.test(t))throw Error("Custom URL can only contain letters, numbers, hyphens, and underscores");if(t.length<3||t.length>20)throw Error("Custom URL must be between 3 and 20 characters");return t};async function u(e,t){let{title:r,longUrl:n,customUrl:l}=e;try{let e;let i=c(n),u=d(l);if(u){let{data:e}=await s.Z.from("urls").select("id").or("custom_url.eq.".concat(u,",short_url.eq.").concat(u)).maybeSingle();if(e)throw Error("Custom URL already taken. Please try another one.")}let f=0;for(;f<3;){e=o(6);let{data:t}=await s.Z.from("urls").select("id").eq("short_url",e).maybeSingle();if(!t)break;f++}if(3===f)throw Error("Failed to generate unique short URL. Please try again.");let{data:h,error:x}=await s.Z.from("urls").insert([{title:r||i,user_id:null,original_url:i,custom_url:u,short_url:e,qr_code:t||null,clicks:0}]).select().single();if(x)throw console.error("Error creating URL:",x),Error(x.message);return a.invalidate("urls_"),h}catch(e){throw console.error("Error in createUrl:",e),Error(e.message||"Error creating short URL")}}async function f(e){try{let{error:t}=await s.Z.from("urls").delete().eq("id",e);if(t)throw t;a.invalidate("*")}catch(e){throw console.error("Error deleting URL:",e),Error("Unable to delete URL")}}},94430:function(e,t,r){"use strict";var s=r(95646);let n="https://epyutufurcgskuzwiqce.supabase.co",a="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImVweXV0dWZ1cmNnc2t1endpcWNlIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjIyMjAzMTAsImV4cCI6MjA3Nzc5NjMxMH0.Dmusxo1ghDmyHQk0Jf_SgEjOTfIk3OJCF0mbuK_sXcM";if(!n||!a)throw console.error("Missing Supabase environment variables. Please set NEXT_PUBLIC_SUPABASE_URL and NEXT_PUBLIC_SUPABASE_ANON_KEY in .env.local"),Error("Missing Supabase environment variables");let l=(0,s.eI)(n,a);t.Z=l},38327:function(e,t,r){"use strict";var s=r(2265);t.Z=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},[r,n]=(0,s.useState)(null),[a,l]=(0,s.useState)(null),[i,o]=(0,s.useState)(null);return{data:r,loading:a,error:i,fn:async function(){for(var r=arguments.length,s=Array(r),a=0;a<r;a++)s[a]=arguments[a];l(!0),o(null);try{let r=await e(t,...s);n(r),o(null)}catch(e){o(e)}finally{l(!1)}}}}},58214:function(e,t,r){"use strict";r.d(t,{cn:function(){return a}});var s=r(44839),n=r(96164);function a(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,n.m6)((0,s.W)(t))}}},function(e){e.O(0,[126,225,289,971,23,744],function(){return e(e.s=69169)}),_N_E=e.O()}]);